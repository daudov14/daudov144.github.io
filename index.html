<!DOCTYPE html>
<html lang="ru" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ê—Ä–∞–±—Å–∫–æ-—Ä—É—Å—Å–∫–∞—è –∏–≥—Ä–∞</title>
<style>
  body {
    margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color: #eee; direction: rtl;
    display: flex; flex-direction: column; min-height: 100vh;
  }
  header {
    background: #222a35; padding: 1rem; text-align: center;
    font-size: 1.5rem; font-weight: 700; color: #0ff;
    letter-spacing: 0.1em; user-select: none;
  }
  main {
    flex-grow: 1; padding: 1rem; max-width: 480px;
    margin: auto; width: 100%;
  }
  section {
    display: none; animation: fadeIn 0.5s ease forwards;
  }
  section.visible {
    display: block;
  }
  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(20px);}
    to {opacity: 1; transform: translateY(0);}
  }
  .button-big {
    display: block; width: 100%; padding: 1rem; margin: 1rem 0;
    font-size: 1.3rem; font-weight: 700; border-radius: 10px;
    border: none; cursor: pointer; background: #0ff; color: #111;
    box-shadow: 0 0 12px #0ff88aa; transition: background 0.3s ease;
  }
  .button-big:hover {
    background: #0cc;
  }
  #wordsList {
    max-height: 300px; overflow-y: auto; background: #203a43dd;
    border-radius: 8px; padding: 0.5rem;
  }
  .word-item {
    padding: 0.4rem 0.6rem; border-bottom: 1px solid #0ff3;
    cursor: pointer; font-size: 1.1rem;
    display: flex; justify-content: space-between;
  }
  .word-item:last-child {
    border-bottom: none;
  }
  .word-item:hover {
    background: #0ff3; color: #111;
  }
  #translation {
    margin-top: 1rem; font-size: 1.4rem; text-align: center;
    font-weight: 600; color: #0ff; user-select: none;
  }
  #playAudio {
    display: block; margin: 1rem auto; background: #0ff;
    border: none; border-radius: 50%; width: 50px; height: 50px;
    font-size: 1.6rem; cursor: pointer; color: #111;
    box-shadow: 0 0 10px #0ff; transition: background 0.3s ease;
  }
  #playAudio:hover {
    background: #0cc;
  }
  #gameHeader {
    display: flex; justify-content: space-between;
    align-items: center; margin-bottom: 1rem;
    font-weight: 700; font-size: 1.2rem; color: #0ff;
  }
  #timer {
    font-size: 1.5rem; font-weight: 800; color: #f55;
    user-select: none; width: 60px; text-align: center;
  }
  #score, #bestScore {
    user-select: none;
  }
  #gameWord {
    font-size: 2.3rem; font-weight: 900; text-align: center;
    margin-bottom: 1rem; color: #0ff; user-select: none;
  }
  #gameOptions {
    display: flex; flex-direction: column; gap: 0.8rem;
  }
  .option-btn {
    padding: 0.8rem; font-size: 1.1rem; border-radius: 8px;
    border: none; cursor: pointer; background: #0a3f4f;
    color: #0ff; font-weight: 700; box-shadow: 0 0 6px #0ff7;
    transition: background 0.3s ease; user-select: none;
  }
  .option-btn:hover:not(:disabled) {
    background: #14a0c8; color: #111;
  }
  .option-btn.correct {
    background: #2ecc40 !important; color: #111;
    box-shadow: 0 0 15px #2ecc40;
  }
  .option-btn.wrong {
    background: #e74c3c !important; color: #fff;
    box-shadow: 0 0 15px #e74c3c;
  }
  .option-btn:disabled {
    cursor: default; opacity: 0.7;
  }
  #nextBtn {
    margin-top: 1rem; width: 100%; background: #0ff;
    color: #111; font-weight: 700; border-radius: 10px;
    padding: 1rem; border: none; cursor: pointer;
    box-shadow: 0 0 10px #0ff; user-select: none;
  }
  #nextBtn:disabled {
    background: #055; cursor: default; opacity: 0.5;
    box-shadow: none;
  }
  #backFromGame, #backFromWords {
    margin-top: 1rem; background: transparent;
    border: 1px solid #0ff; color: #0ff;
    border-radius: 10px; padding: 0.6rem 1rem;
    cursor: pointer; font-weight: 700; user-select: none;
  }
  #backFromGame:hover, #backFromWords:hover {
    background: #0ff; color: #111;
  }
  #wordsList::-webkit-scrollbar {
    width: 8px;
  }
  #wordsList::-webkit-scrollbar-thumb {
    background-color: #0ff6; border-radius: 4px;
  }
  #wordsList::-webkit-scrollbar-track {
    background: transparent;
  }
</style>
</head>
<body>

<header>üïå –ê—Ä–∞–±—Å–∫–æ-—Ä—É—Å—Å–∫–∞—è –∏–≥—Ä–∞</header>

<main>
  <section id="menu" class="visible" aria-label="–ù–∞—á–∞–ª—å–Ω–æ–µ –º–µ–Ω—é">
    <button id="btnWords" class="button-big" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–æ–≤–∞–º">üìñ –í—Å–µ —Å–ª–æ–≤–∞</button>
    <button id="btnGame" class="button-big" aria-label="–ù–∞—á–∞—Ç—å –∏–≥—Ä—É">üéÆ –ò–≥—Ä–∞—Ç—å</button>
  </section>

  <section id="wordsSection" aria-label="–°–ª–æ–≤–∞">
    <button id="backFromWords" aria-label="–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥">‚¨Ö –ù–∞–∑–∞–¥</button>
    <div id="wordsList" role="list" tabindex="0" aria-live="polite" aria-atomic="true"></div>
    <div id="translation" aria-live="polite"></div>
    <button id="playAudio" aria-label="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å —Å–ª–æ–≤–æ" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å —Å–ª–æ–≤–æ" style="display:none;">üîä</button>
  </section>

  <section id="gameSection" aria-label="–ò–≥—Ä–∞">
    <div id="gameHeader">
      <div id="score">–û—á–∫–∏: 0</div>
      <div id="timer" aria-live="polite" aria-atomic="true" role="timer">15</div>
      <div id="bestScore">–õ—É—á—à–∏–π: 0</div>
    </div>
    <div id="gameWord" aria-live="polite" aria-atomic="true"></div>
    <div id="gameOptions"></div>
    <button id="nextBtn" disabled>–°–ª–µ–¥—É—é—â–µ–µ —Å–ª–æ–≤–æ</button>
    <button id="backFromGame" aria-label="–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥">‚¨Ö –ù–∞–∑–∞–¥</button>
  </section>
</main>

<script>
const wordsData = [
  {id:1, word:"ŸÉÿ™ÿßÿ®", translation:"–ö–Ω–∏–≥–∞", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/book--_ru_1.mp3"},
  {id:2, word:"ŸÖÿØÿ±ÿ≥ÿ©", translation:"–®–∫–æ–ª–∞", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/school--_ru_1.mp3"},
  {id:3, word:"ŸÇŸÑŸÖ", translation:"–†—É—á–∫–∞", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/pen--_ru_1.mp3"},
  {id:4, word:"ÿ™ŸÅÿßÿ≠ÿ©", translation:"–Ø–±–ª–æ–∫–æ", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/apple--_ru_1.mp3"},
  {id:5, word:"ŸÖÿßÿ°", translation:"–í–æ–¥–∞", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/water--_ru_1.mp3"},
  {id:6, word:"ÿ≥Ÿäÿßÿ±ÿ©", translation:"–ú–∞—à–∏–Ω–∞", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/car--_ru_1.mp3"},
  {id:7, word:"ÿ∑ÿßÿ¶ÿ±ÿ©", translation:"–°–∞–º–æ–ª—ë—Ç", audio:"https://ssl.gstatic.com/dictionary/static/sounds/oxford/plane--_ru_1.mp3"},
];

const menu = document.getElementById('menu');
const btnWords = document.getElementById('btnWords');
const btnGame = document.getElementById('btnGame');
const wordsSection = document.getElementById('wordsSection');
const wordsList = document.getElementById('wordsList');
const translation = document.getElementById('translation');
const playAudioBtn = document.getElementById('playAudio');
const backFromWords = document.getElementById('backFromWords');

const gameSection = document.getElementById('gameSection');
const scoreDisplay = document.getElementById('score');
const bestScoreDisplay = document.getElementById('bestScore');
const timerDisplay = document.getElementById('timer');
const gameWord = document.getElementById('gameWord');
const gameOptions = document.getElementById('gameOptions');
const nextBtn = document.getElementById('nextBtn');
const backFromGame = document.getElementById('backFromGame');

let audio = new Audio();
let currentWord = null;
let score = 0;
let bestScore = parseInt(localStorage.getItem('bestScore')) || 0;
let timer = null;
const timePerWord = 15;
let timeLeft = timePerWord;
let gameActive = false;
let usedIndices = new Set();

btnWords.onclick = () => {
  showSection(wordsSection);
  showWords();
};
btnGame.onclick = () => {
  startGame();
};
backFromWords.onclick = () => {
  stopAudio();
  showSection(menu);
  clearWords();
};
backFromGame.onclick = () => {
  stopAudio();
  gameActive = false;
  clearInterval(timer);
  showSection(menu);
};
nextBtn.onclick = () => {
  if (!nextBtn.disabled) {
    nextBtn.disabled = true;
    nextWord();
  }
};

playAudioBtn.onclick = () => {
  if(currentWord && currentWord.audio) playSound(currentWord.audio);
};

function showSection(section) {
  [menu, wordsSection, gameSection].forEach(s => s.classList.remove('visible'));
  section.classList.add('visible');
}

function showWords() {
  wordsList.innerHTML = '';
  translation.textContent = '';
  playAudioBtn.style.display = 'none';

  wordsData.forEach(word => {
    const div = document.createElement('div');
    div.className = 'word-item';
    div.textContent = `${word.word} ‚Äî ${word.translation}`;
    div.tabIndex = 0;
    div.onclick = () => showTranslation(word);
    div.onkeypress = e => { if(e.key === 'Enter') showTranslation(word); };
    wordsList.appendChild(div);
  });
}

function showTranslation(word) {
  translation.textContent = `${word.word} ‚Äî ${word.translation}`;
  currentWord = word;
  if(word.audio) {
    playAudioBtn.style.display = 'block';
  } else {
    playAudioBtn.style.display = 'none';
  }
}

function clearWords() {
  wordsList.innerHTML = '';
  translation.textContent = '';
  playAudioBtn.style.display = 'none';
}

function playSound(url) {
  stopAudio();
  audio = new Audio(url);
  audio.play();
}

function stopAudio() {
  if(audio) {
    audio.pause();
    audio.currentTime = 0;
  }
}

function startGame() {
  score = 0;
  timeLeft = timePerWord;
  usedIndices.clear();
  bestScoreDisplay.textContent = `–õ—É—á—à–∏–π: ${bestScore}`;
  scoreDisplay.textContent = `–û—á–∫–∏: ${score}`;
  timerDisplay.textContent = timeLeft;
  gameActive = true;
  showSection(gameSection);
  nextBtn.disabled = true;
  nextWord();
}

function nextWord() {
  resetGameUI();
  if(usedIndices.size === wordsData.length) {
    endGame();
    return;
  }

  // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ, –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—â—ë –Ω–µ –±—ã–ª–æ
  let index;
  do {
    index = Math.floor(Math.random() * wordsData.length);
  } while(usedIndices.has(index));
  usedIndices.add(index);

  currentWord = wordsData[index];
  gameWord.textContent = currentWord.word;

  // –°–æ–±–∏—Ä–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (4 –≤–∞—Ä–∏–∞–Ω—Ç–∞, –æ–¥–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
  let options = [currentWord.translation];
  while(options.length < 4) {
    let rand = wordsData[Math.floor(Math.random() * wordsData.length)].translation;
    if(!options.includes(rand)) options.push(rand);
  }

  // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
  options = shuffle(options);

  options.forEach(opt => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.textContent = opt;
    btn.onclick = () => selectAnswer(btn, opt);
    gameOptions.appendChild(btn);
  });

  timeLeft = timePerWord;
  timerDisplay.textContent = timeLeft;
  startTimer();
}

function resetGameUI() {
  gameOptions.innerHTML = '';
  gameWord.textContent = '';
  clearInterval(timer);
  nextBtn.disabled = true;
}

function selectAnswer(button, chosen) {
  if(!gameActive) return;
  clearInterval(timer);
  const buttons = gameOptions.querySelectorAll('button');
  buttons.forEach(b => b.disabled = true);

  if(chosen === currentWord.translation) {
    button.classList.add('correct');
    score++;
    scoreDisplay.textContent = `–û—á–∫–∏: ${score}`;
    playCorrectSound();
  } else {
    button.classList.add('wrong');
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    buttons.forEach(b => {
      if(b.textContent === currentWord.translation) b.classList.add('correct');
    });
    playWrongSound();
  }
  nextBtn.disabled = false;
}

function endGame() {
  gameActive = false;
  clearInterval(timer);
  alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á–µ—Ç: ${score}`);
  if(score > bestScore) {
    bestScore = score;
    localStorage.setItem('bestScore', bestScore);
    bestScoreDisplay.textContent = `–õ—É—á—à–∏–π: ${bestScore}`;
    alert('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!');
  }
  showSection(menu);
}

function startTimer() {
  clearInterval(timer);
  timer = setInterval(() => {
    timeLeft--;
    timerDisplay.textContent = timeLeft;
    if(timeLeft <= 0) {
      clearInterval(timer);
      selectAnswerTimeout();
    }
  }, 1000);
}

function selectAnswerTimeout() {
  if(!gameActive) return;
  const buttons = gameOptions.querySelectorAll('button');
  buttons.forEach(b => b.disabled = true);
  buttons.forEach(b => {
    if(b.textContent === currentWord.translation) b.classList.add('correct');
  });
  playWrongSound();
  nextBtn.disabled = false;
}

function shuffle(array) {
  for(let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function playCorrectSound() {
  const sound = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
  sound.play();
}
function playWrongSound() {
  const sound = new Audio('https://actions.google.com/sounds/v1/cartoon/boing.ogg');
  sound.play();
}
</script>

</body>
</html>
