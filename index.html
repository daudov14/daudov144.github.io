<!DOCTYPE html>
<html lang="ru" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ê—Ä–∞–±—Å–∫–æ-—Ä—É—Å—Å–∫–∞—è –∏–≥—Ä–∞</title>
<style>
/* üëá –æ—Å—Ç–∞–≤–ª—è–µ–º –≤–∞—à –¥–∏–∑–∞–π–Ω –∫–∞–∫ –µ—Å—Ç—å */
body {
  margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  color: #eee; direction: rtl;
  display: flex; flex-direction: column; min-height: 100vh;
}
header {
  background: #222a35; padding: 1rem; text-align: center;
  font-size: 1.5rem; font-weight: 700; color: #0ff;
  letter-spacing: 0.1em; user-select: none;
}
main {
  flex-grow: 1; padding: 1rem; max-width: 480px;
  margin: auto; width: 100%;
}
section { display: none; animation: fadeIn 0.5s ease forwards; }
section.visible { display: block; }
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(20px);}
  to {opacity: 1; transform: translateY(0);}
}
.button-big {
  display: block; width: 100%; padding: 1rem; margin: 1rem 0;
  font-size: 1.3rem; font-weight: 700; border-radius: 10px;
  border: none; cursor: pointer; background: #0ff; color: #111;
  box-shadow: 0 0 12px #0ff88aa; transition: background 0.3s ease;
}
.button-big:hover { background: #0cc; }
#gameHeader {
  display: flex; justify-content: space-between;
  align-items: center; margin-bottom: 1rem;
  font-weight: 700; font-size: 1.2rem; color: #0ff;
}
#timer {
  font-size: 1.5rem; font-weight: 800; color: #f55;
  user-select: none; width: 60px; text-align: center;
}
#score, #bestScore { user-select: none; }
#gameWord {
  font-size: 2.3rem; font-weight: 900; text-align: center;
  margin-bottom: 1rem; color: #0ff; user-select: none;
}
.option-btn {
  padding: 0.8rem; font-size: 1.1rem; border-radius: 8px;
  border: none; cursor: pointer; background: #0a3f4f;
  color: #0ff; font-weight: 700; box-shadow: 0 0 6px #0ff7;
  transition: background 0.3s ease; user-select: none;
}
.option-btn:hover:not(:disabled) { background: #14a0c8; color: #111; }
.option-btn.correct {
  background: #2ecc40 !important; color: #111;
  box-shadow: 0 0 15px #2ecc40;
}
.option-btn.wrong {
  background: #e74c3c !important; color: #fff;
  box-shadow: 0 0 15px #e74c3c;
}
.option-btn:disabled { cursor: default; opacity: 0.7; }
</style>
</head>
<body>

<header>üïå –ê—Ä–∞–±—Å–∫–æ-—Ä—É—Å—Å–∫–∞—è –∏–≥—Ä–∞</header>

<main>
  <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
  <section id="register" class="visible">
    <label>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</label>
    <input type="text" id="usernameInput" style="width:100%;padding:0.5rem;margin:1rem 0;" />
    <button id="registerBtn" class="button-big">‚úÖ –í–æ–π—Ç–∏</button>
  </section>

  <!-- –ú–µ–Ω—é -->
  <section id="menu">
    <button id="btnGame" class="button-big">üéÆ –ò–≥—Ä–∞—Ç—å</button>
  </section>

  <!-- –ò–≥—Ä–∞ -->
  <section id="gameSection">
    <div id="gameHeader">
      <div id="score">–û—á–∫–∏: 0</div>
      <div id="timer">15</div>
      <div id="bestScore">–õ—É—á—à–∏–π: 0</div>
    </div>
    <div id="gameWord"></div>
    <div id="gameOptions"></div>
  </section>
</main>

<script>
const wordsData = [
  {word:"ŸÉÿ™ÿßÿ®", translation:"–ö–Ω–∏–≥–∞"},
  {word:"ŸÖÿØÿ±ÿ≥ÿ©", translation:"–®–∫–æ–ª–∞"},
  {word:"ŸÇŸÑŸÖ", translation:"–†—É—á–∫–∞"},
  {word:"ÿ™ŸÅÿßÿ≠ÿ©", translation:"–Ø–±–ª–æ–∫–æ"},
  {word:"ŸÖÿßÿ°", translation:"–í–æ–¥–∞"},
  {word:"ÿ≥Ÿäÿßÿ±ÿ©", translation:"–ú–∞—à–∏–Ω–∞"},
  {word:"ÿ∑ÿßÿ¶ÿ±ÿ©", translation:"–°–∞–º–æ–ª—ë—Ç"},
];

const register = document.getElementById('register');
const menu = document.getElementById('menu');
const gameSection = document.getElementById('gameSection');
const registerBtn = document.getElementById('registerBtn');
const usernameInput = document.getElementById('usernameInput');
const btnGame = document.getElementById('btnGame');
const scoreDisplay = document.getElementById('score');
const bestScoreDisplay = document.getElementById('bestScore');
const timerDisplay = document.getElementById('timer');
const gameWord = document.getElementById('gameWord');
const gameOptions = document.getElementById('gameOptions');

let username = localStorage.getItem('username') || null;
let score = 0;
let bestScore = parseInt(localStorage.getItem('bestScore')) || 0;
let timer = null;
let timeLeft = 15;
let usedIndices = new Set();
let currentWord = null;
let gameActive = false;

if (username) {
  showSection(menu);
} else {
  showSection(register);
}

registerBtn.onclick = () => {
  const name = usernameInput.value.trim();
  if (name) {
    username = name;
    localStorage.setItem('username', username);
    showSection(menu);
  }
};

btnGame.onclick = () => startGame();

function showSection(section) {
  [register, menu, gameSection].forEach(s => s.classList.remove('visible'));
  section.classList.add('visible');
}

function startGame() {
  score = 0;
  usedIndices.clear();
  bestScoreDisplay.textContent = `–õ—É—á—à–∏–π: ${bestScore}`;
  scoreDisplay.textContent = `–û—á–∫–∏: ${score}`;
  gameActive = true;
  showSection(gameSection);
  nextWord();
}

function nextWord() {
  resetGameUI();
  if(usedIndices.size === wordsData.length) {
    endGame();
    return;
  }

  let index;
  do {
    index = Math.floor(Math.random() * wordsData.length);
  } while(usedIndices.has(index));
  usedIndices.add(index);

  currentWord = wordsData[index];
  gameWord.textContent = currentWord.word;
  speakWord(currentWord.word);

  let options = [currentWord.translation];
  while(options.length < 4) {
    let rand = wordsData[Math.floor(Math.random() * wordsData.length)].translation;
    if(!options.includes(rand)) options.push(rand);
  }
  options = shuffle(options);

  options.forEach(opt => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.textContent = opt;
    btn.onclick = () => selectAnswer(btn, opt);
    gameOptions.appendChild(btn);
  });

  timeLeft = 15;
  timerDisplay.textContent = timeLeft;
  startTimer();
}

function resetGameUI() {
  gameOptions.innerHTML = '';
  gameWord.textContent = '';
  clearInterval(timer);
}

function selectAnswer(button, chosen) {
  if(!gameActive) return;
  clearInterval(timer);

  const buttons = gameOptions.querySelectorAll('button');
  buttons.forEach(b => b.disabled = true);

  if(chosen === currentWord.translation) {
    button.classList.add('correct');
    score++;
    scoreDisplay.textContent = `–û—á–∫–∏: ${score}`;
    setTimeout(nextWord, 1000);
  } else {
    button.classList.add('wrong');
    buttons.forEach(b => {
      if(b.textContent === currentWord.translation) b.classList.add('correct');
    });
    playWrongSound();
    setTimeout(endGame, 1000);
  }
}

function endGame() {
  gameActive = false;
  clearInterval(timer);
  alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Å—á—ë—Ç: ${score}`);
  if(score > bestScore) {
    bestScore = score;
    localStorage.setItem('bestScore', bestScore);
    alert('üéâ –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!');
  }
  showSection(menu);
}

function startTimer() {
  clearInterval(timer);
  timer = setInterval(() => {
    timeLeft--;
    timerDisplay.textContent = timeLeft;
    if(timeLeft <= 0) {
      clearInterval(timer);
      playWrongSound();
      endGame();
    }
  }, 1000);
}

function shuffle(array) {
  for(let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function playWrongSound() {
  const sound = new Audio('https://actions.google.com/sounds/v1/cartoon/boing.ogg');
  sound.play();
}

function speakWord(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'ar-SA';
  speechSynthesis.speak(utterance);
}
</script>

</body>
</html>
